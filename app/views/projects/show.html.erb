<%= javascript_include_tag 'shared/task_list' %>
<%= stylesheet_link_tag 'shared/task_list' %>

<%= stylesheet_link_tag "projects/show" %>

<script type="text/javascript">
  var AUTOCOMPLETE_DATA = <%= ((Task::KINDS.map do |kind|
    [kind, "kind", kind]
  end) + (User.all.map do |u| 
    [u.name, "assignee_id", u.id]
  end)).transpose.to_json %>;
</script>

<% 
  @hide_layout_title = true
  @title = @project.title
%>

<h1>
  <% if @project.assignees.any? %>
    <ul class="clearfix" id="project_fields">
      <li>
        <span>Who's Involved</span>
        <div>
        <%= @project.assignees.map do |u|
           link_to_user u
         end.join(", ") %>
        </div>
      </li>
    </ul>
  <% end %>
  <%= @title %>
</h1>

<%= render :partial => "project_nav", :locals => {:project => @project} %>

<div id="project_content">
  <% task_object = Task.new(:kind => "task", :status => "prioritized",
                            :project_id => @project.id) %>
  <%= render :partial => "/shared/task_list",
             :locals => {:title => "PRIORITIZED (#{@project.task_list.size})",
                         :tasks => @project.task_list,
                         :context => @project.class.name,
                         :task_object => task_object} %>

  <%= render :partial => "/shared/task_list",
             :locals => {:title =>
                        "RECENTLY COMPLETED (#{@project.completed_tasks.size})",
                         :tasks => @project.completed_tasks,
                         :context => @project.class.name} %>

  <% task_object = Task.new(:kind => "task", :status => "parked",
                            :project_id => @project.id) %>

  <%= render :partial => "/shared/task_list",
             :locals => {:title =>
                          "PARKING LOT (#{@project.parked_tasks.size})",
                         :tasks => @project.parked_tasks,
                         :context => @project.class.name,
                         :task_object => task_object} %>
</div>
<div id="project_footer">
  <% if @project.active? %>
    <%= link_to "Remove from Active Initiatives",
      set_inactive_project_path(@project), :method => :put %>
    Initiative Status: <strong>Active</strong>
  <% else %>
    <%= link_to "Add to Active Initiatives",
      set_active_project_path(@project), :method => :put %>
    Initiative Status: <strong>Inactive</strong>
  <% end %>
</div>